
Debian GNU/Linux 11 syzkaller ttyS0

Warning: Permanently added '[localhost]:13751' (ECDSA) to the list of known hosts.
syzkaller login: [   75.839282][   T44] audit: type=1400 audit(1734559261.807:10): avc:  denied  { execmem } for  pid=419 comm="syz-executor415" scontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tcontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tclass=process permissive=1
Setting up swapspace version 1, size = 122.1 MiB (127995904 bytes)
no label, UUID=2a2ac912-6a27-44f9-a380-a51ce1a37037
[   75.974001][  T419] Adding 124996k swap on ./swap-file.  Priority:0 extents:1 across:124996k 
executing program
executing program
executing program
[   76.093959][  T440] loop0: detected capacity change from 0 to 2048
[   76.096203][  T438] loop1: detected capacity change from 0 to 2048
executing program
[   76.107463][  T440] UDF-fs: warning (device loop0): udf_load_vrs: No anchor found
[   76.108746][  T438] UDF-fs: warning (device loop1): udf_load_vrs: No anchor found
[   76.109888][  T440] UDF-fs: Scanning with blocksize 512 failed
[   76.112089][  T438] UDF-fs: Scanning with blocksize 512 failed
[   76.120467][  T440] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
[   76.121908][  T441] loop4: detected capacity change from 0 to 2048
[   76.124358][  T438] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
executing program
[   76.128534][  T439] loop2: detected capacity change from 0 to 2048
[   76.132352][  T441] UDF-fs: warning (device loop4): udf_load_vrs: No anchor found
[   76.134515][  T441] UDF-fs: Scanning with blocksize 512 failed
[   76.141732][  T441] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
[   76.157212][  T442] loop6: detected capacity change from 0 to 2048
[   76.169758][  T442] UDF-fs: warning (device loop6): udf_load_vrs: No anchor found
[   76.170040][  T439] UDF-fs: warning (device loop2): udf_load_vrs: No anchor found
[   76.172072][  T442] UDF-fs: Scanning with blocksize 512 failed
[   76.176117][  T439] UDF-fs: Scanning with blocksize 512 failed
[   76.181178][  T442] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
executing program
executing program
executing program
[   76.200474][  T439] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
[   76.227658][  T444] loop5: detected capacity change from 0 to 2048
[   76.227707][  T443] loop3: detected capacity change from 0 to 2048
[   76.242213][  T444] UDF-fs: warning (device loop5): udf_load_vrs: No anchor found
[   76.244547][  T443] UDF-fs: warning (device loop3): udf_load_vrs: No anchor found
[   76.244578][  T444] UDF-fs: Scanning with blocksize 512 failed
[   76.249321][  T443] UDF-fs: Scanning with blocksize 512 failed
[   76.251310][  T445] loop7: detected capacity change from 0 to 2048
[   76.262518][  T444] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
[   76.266928][  T445] UDF-fs: warning (device loop7): udf_load_vrs: No anchor found
[   76.269132][  T445] UDF-fs: Scanning with blocksize 512 failed
[   76.270559][  T443] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
[   76.296397][  T445] UDF-fs: INFO Mounting volume 'LinuxUDF', timestamp 2022/11/22 14:59 (1000)
[   76.960330][  T436] UDF-fs: error (device loop4): udf_read_inode: (ino 833) failed !bh
[   76.966747][  T436] UDF-fs: error (device loop4): udf_read_inode: (ino 833) failed !bh
[   76.993150][  T427] UDF-fs: error (device loop1): udf_read_inode: (ino 833) failed !bh
[   76.997289][  T427] UDF-fs: error (device loop1): udf_read_inode: (ino 833) failed !bh
[   77.001034][  T436] ==================================================================
[   77.001869][  T436] BUG: KASAN: use-after-free in udf_close_lvid+0x51b/0x5e0
[   77.001869][  T436] Write of size 1 at addr ff11000045506460 by task syz-executor415/436
[   77.001869][  T436] 
[   77.001869][  T436] CPU: 2 UID: 0 PID: 436 Comm: syz-executor415 Not tainted 6.13.0-rc3 #5
[   77.001869][  T436] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
[   77.001869][  T436] Call Trace:
[   77.001869][  T436]  <TASK>
[   77.001869][  T436]  dump_stack_lvl+0x116/0x1b0
[   77.001869][  T436]  print_report+0xcf/0x5f0
[   77.001869][  T436]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.001869][  T436]  ? __phys_addr+0xeb/0x180
[   77.001869][  T436]  ? udf_close_lvid+0x51b/0x5e0
[   77.001869][  T436]  kasan_report+0x93/0xc0
[   77.001869][  T436]  ? udf_close_lvid+0x51b/0x5e0
[   77.001869][  T436]  udf_close_lvid+0x51b/0x5e0
[   77.001869][  T436]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.001869][  T436]  udf_put_super+0x186/0x1e0
[   77.001869][  T436]  ? __pfx_udf_put_super+0x10/0x10
[   77.001869][  T436]  generic_shutdown_super+0x14e/0x380
[   77.001869][  T436]  kill_block_super+0x3b/0x90
[   77.001869][  T436]  deactivate_locked_super+0xbb/0x130
[   77.001869][  T436]  deactivate_super+0xb1/0xd0
[   77.001869][  T436]  cleanup_mnt+0x378/0x510
[   77.001869][  T436]  task_work_run+0x173/0x280
[   77.001869][  T436]  ? __pfx_task_work_run+0x10/0x10
[   77.001869][  T436]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.001869][  T436]  ? switch_task_namespaces+0xe2/0x100
[   77.001869][  T436]  do_exit+0xa68/0x2fe0
[   77.001869][  T436]  ? do_group_exit+0x101/0x2a0
[   77.001869][  T436]  ? __pfx_lock_release+0x10/0x10
[   77.001869][  T436]  ? zap_other_threads+0x26b/0x310
[   77.001869][  T436]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.001869][  T436]  ? __pfx_do_exit+0x10/0x10
[   77.001869][  T436]  ? __pfx_do_raw_spin_lock+0x10/0x10
[   77.001869][  T436]  ? _raw_spin_unlock_irq+0x23/0x50
[   77.001869][  T436]  ? _raw_spin_unlock_irq+0x23/0x50
[   77.001869][  T436]  do_group_exit+0xd3/0x2a0
[   77.001869][  T436]  __x64_sys_exit_group+0x3e/0x50
[   77.001869][  T436]  x64_sys_call+0xf6a/0x1890
[   77.001869][  T436]  do_syscall_64+0xc3/0x1d0
[   77.001869][  T436]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[   77.001869][  T436] RIP: 0033:0x7f7754215d26
[   77.001869][  T436] Code: Unable to access opcode bytes at 0x7f7754215cfc.
[   77.001869][  T436] RSP: 002b:00007ffe6057ff68 EFLAGS: 00000246 ORIG_RAX: 00000000000000e7
[   77.001869][  T436] RAX: ffffffffffffffda RBX: 00007f77542a12d0 RCX: 00007f7754215d26
[   77.001869][  T436] RDX: 0000000000000001 RSI: 000000000000003c RDI: 0000000000000001
[   77.001869][  T436] RBP: 0000000000000001 R08: 00000000000000e7 R09: ffffffffffffffc0
[   77.075026][  T430] UDF-fs: error (device loop2): udf_read_inode: (ino 833) failed !bh
[   77.001869][  T436] R10: 00000000fffffffb R11: 0000000000000246 R12: 00007f77542a12d0
[   77.001869][  T436] R13: 0000000000000001 R14: 0000000000000000 R15: 0000000000000001
[   77.078920][  T436]  </TASK>
[   77.078920][  T436] 
[   77.078920][  T436] The buggy address belongs to the physical page:
[   77.078920][  T436] page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x45506
[   77.078920][  T436] flags: 0x100000000000000(node=0|zone=1)
[   77.078920][  T436] raw: 0100000000000000 ffd4000001154188 ffd4000001154188 0000000000000000
[   77.090045][  T430] UDF-fs: error (device loop2): udf_read_inode: (ino 833) failed !bh
[   77.078920][  T436] raw: 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000
[   77.078920][  T436] page dumped because: kasan: bad access detected
[   77.078920][  T436] 
[   77.078920][  T436] Memory state around the buggy address:
[   77.078920][  T436]  ff11000045506300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   77.078920][  T436]  ff11000045506380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   77.078920][  T436] >ff11000045506400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   77.078920][  T436]                                                        ^
[   77.078920][  T436]  ff11000045506480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   77.078920][  T436]  ff11000045506500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
[   77.078920][  T436] ==================================================================
[   77.115523][  T436] Disabling lock debugging due to kernel taint
[   77.122339][  T433] UDF-fs: error (device loop3): udf_read_inode: (ino 833) failed !bh
[   77.125228][  T433] UDF-fs: error (device loop3): udf_read_inode: (ino 833) failed !bh
[   77.147134][  T437] UDF-fs: error (device loop7): udf_read_inode: (ino 833) failed !bh
[   77.155532][  T437] UDF-fs: error (device loop7): udf_read_inode: (ino 833) failed !bh
[   77.159896][  T426] UDF-fs: error (device loop0): udf_read_inode: (ino 833) failed !bh
[   77.163006][  T426] UDF-fs: error (device loop0): udf_read_inode: (ino 833) failed !bh
[   77.185468][  T434] UDF-fs: error (device loop5): udf_read_inode: (ino 833) failed !bh
[   77.190364][  T434] UDF-fs: error (device loop5): udf_read_inode: (ino 833) failed !bh
[   77.210620][  T435] UDF-fs: error (device loop6): udf_read_inode: (ino 833) failed !bh
[   77.217981][  T435] UDF-fs: error (device loop6): udf_read_inode: (ino 833) failed !bh

VM DIAGNOSIS:
06:01:03  Registers:
info registers vcpu 0
RAX=0000000000000000 RBX=0000000000001000 RCX=ffffffff8d3d5b31 RDX=0000000000001000
RSI=ff11000003b1a340 RDI=0000000000000003 RBP=0000000000001000 RSP=ffa00000039c77d8
R8 =0000000000000000 R9 =ffe21c000231c9b4 R10=ffe21c000231c9b3 R11=ff110000118e4d9f
R12=0000000000001000 R13=dffffc0000000000 R14=ffd4000000532200 R15=ff110000118e50e8
RIP=ffffffff8d3d5b34 RFL=00000206 [-----P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 000055558148f880 00000000 00000000
GS =0000 ff11000053a00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe2c1b881000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe2c1b87f000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000000020056000 CR3=0000000003bc0002 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=00000000009896800000000000000000 XMM01=00000000000000000000000000989680
XMM02=ffffffffffffff00ffff000000000000 XMM03=00000000000000000000000000000000
XMM04=0000000000ff000000000000000000ff XMM05=00000000000000000000000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=00000000000000000000000000000000 XMM09=00000000000000000000000000000000
XMM10=00000000000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
info registers vcpu 1
RAX=0000000000730e00 RBX=1ff4000000730ed6 RCX=ffffffff8cc7d824 RDX=1fe2200000a54d55
RSI=ff11000014900000 RDI=0000000000000002 RBP=ffd4000000725b80 RSP=ffa0000003987690
R8 =fff3fc0000730e00 R9 =fff3fc0000730ee4 R10=fff3fc0000730ee3 R11=0000000000000003
R12=ff110000052a6a90 R13=000000000003b18c R14=0000000000000000 R15=ffd4000000725b98
RIP=ffffffff8d031424 RFL=00000046 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 000055558148f880 00000000 00000000
GS =0000 ff11000053a80000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe479c01b000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe479c019000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f77542a2140 CR3=0000000013be2001 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=00000000009896800000000000000000 XMM01=00000000000000000000000000989680
XMM02=ffffffffffffff00ffff000000000000 XMM03=00000000000000000000000000000000
XMM04=0000000000ff000000000000000000ff XMM05=00000000000000000000000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=00000000000000000000000000000000 XMM09=00000000000000000000000000000000
XMM10=00000000000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
info registers vcpu 2
RAX=00000000ffffe500 RBX=ffffffff97227ed0 RCX=ffffffff8ccb1211 RDX=00003fffffffffff
RSI=ff11000005b00000 RDI=0000000000000003 RBP=0000000000000058 RSP=ffa00000038a74c8
R8 =00000000ffffe500 R9 =fffffbfff2e44fdd R10=fffffbfff2e44fdc R11=ffffffff97227ee7
R12=00003fffffffffff R13=fffffffffffd8820 R14=fffffffffffd8878 R15=00003fffffffffff
RIP=ffffffff8ccb1214 RFL=00000046 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ff11000053b00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe7228941000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe722893f000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00000000200ce000 CR3=0000000009f86003 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=000007e8002b00000602011603120c02 XMM01=00007f96af69dc4000007f96af69a4a0
XMM02=ffffffffffffff0f0e0d0c0b0a090807 XMM03=00000000000000000000000000000000
XMM04=00000000000000000000000000000000 XMM05=00000000000000000000000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=00000000000000200000000000002000 XMM09=0000ffffffffffffffffffffffffff00
XMM10=00000000000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
info registers vcpu 3
RAX=0000000000000000 RBX=ff110000170be658 RCX=ffffffff8d3c91dd RDX=0000000000000001
RSI=ff11000013f2a340 RDI=0000000000000002 RBP=ffffffff8d3c9201 RSP=ffa00000039d7978
R8 =0000000000000000 R9 =ffe21c0002e17ccc R10=ffe21c0002e17ccb R11=ff110000170be65f
R12=0000000000000000 R13=dffffc0000000000 R14=0000000000000000 R15=0000000000000000
RIP=ffffffff8ce9a28c RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 000055558148f880 00000000 00000000
GS =0000 ff11000053b80000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe7065ca7000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe7065ca5000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000000002005b000 CR3=0000000013844005 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=00000000009896800000000000000000 XMM01=00000000000000000000000000989680
XMM02=ffffffffffffff00ffff000000000000 XMM03=00000000000000000000000000000000
XMM04=0000000000ff000000000000000000ff XMM05=00000000000000000000000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=00000000000000000000000000000000 XMM09=00000000000000000000000000000000
XMM10=00000000000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
