Warning: Permanently added '[localhost]:50965' (ECDSA) to the list of known hosts.
[   77.125650][   T44] audit: type=1400 audit(1734535507.665:9): avc:  denied  { execmem } for  pid=417 comm="syz-executor144" scontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tcontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tclass=process permissive=1
executing program
[   77.151225][  T418] loop0: detected capacity change from 0 to 1024
[   77.177858][  T417] ==================================================================
[   77.178288][  T417] BUG: KASAN: slab-out-of-bounds in hfsplus_uni2asc+0x96a/0xa60
[   77.178288][  T417] Read of size 2 at addr ff1100000997940c by task syz-executor144/417
[   77.178288][  T417] 
[   77.178288][  T417] CPU: 0 UID: 0 PID: 417 Comm: syz-executor144 Not tainted 6.13.0-rc3 #3
[   77.178288][  T417] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
[   77.178288][  T417] Call Trace:
[   77.178288][  T417]  <TASK>
[   77.178288][  T417]  dump_stack_lvl+0x116/0x1b0
[   77.178288][  T417]  print_report+0xcf/0x5f0
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? __phys_addr+0xeb/0x180
[   77.178288][  T417]  ? hfsplus_uni2asc+0x96a/0xa60
[   77.178288][  T417]  ? __pfx_uni2char+0x10/0x10
[   77.178288][  T417]  kasan_report+0x93/0xc0
[   77.178288][  T417]  ? hfsplus_uni2asc+0x96a/0xa60
[   77.178288][  T417]  hfsplus_uni2asc+0x96a/0xa60
[   77.178288][  T417]  ? __pfx_uni2char+0x10/0x10
[   77.178288][  T417]  hfsplus_readdir+0x83e/0xfd0
[   77.178288][  T417]  ? __pfx_hfsplus_readdir+0x10/0x10
[   77.178288][  T417]  ? lockdep_unlock+0xe7/0x240
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? __lock_acquire+0x24cf/0x4a10
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? rcu_is_watching+0x12/0xc0
[   77.178288][  T417]  ? __pfx_lock_acquire+0x10/0x10
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? down_read_killable+0x14a/0x500
[   77.178288][  T417]  ? write_comp_data+0x29/0x90
[   77.178288][  T417]  ? __pfx_down_read_killable+0x10/0x10
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? selinux_file_permission+0x95/0x550
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? write_comp_data+0x29/0x90
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  iterate_dir+0x534/0xb40
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  __x64_sys_getdents64+0x154/0x2e0
[   77.178288][  T417]  ? srso_alias_return_thunk+0x5/0xfbef5
[   77.178288][  T417]  ? __sanitizer_cov_trace_pc+0x20/0x60
[   77.178288][  T417]  ? __pfx___x64_sys_getdents64+0x10/0x10
[   77.178288][  T417]  ? write_comp_data+0x29/0x90
[   77.178288][  T417]  ? __pfx_filldir64+0x10/0x10
[   77.178288][  T417]  ? do_syscall_64+0x89/0x1d0
[   77.178288][  T417]  ? do_syscall_64+0x89/0x1d0
[   77.178288][  T417]  do_syscall_64+0xc3/0x1d0
[   77.178288][  T417]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[   77.178288][  T417] RIP: 0033:0x7f5508840f9b
[   77.178288][  T417] Code: eb b5 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 f3 0f 1e fa 48 81 fa ff ff ff 7f b8 ff ff ff 7f 48 0f 47 d0 b8 d9 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 c0 ff ff ff f7 d8
[   77.178288][  T417] RSP: 002b:00007ffd3d428a18 EFLAGS: 00000293 ORIG_RAX: 00000000000000d9
[   77.178288][  T417] RAX: ffffffffffffffda RBX: 0000555557cb4be0 RCX: 00007f5508840f9b
[   77.178288][  T417] RDX: 0000000000008000 RSI: 0000555557cb4be0 RDI: 0000000000000004
[   77.178288][  T417] RBP: ffffffffffffffc0 R08: 0000000000000030 R09: 000000000000007c
[   77.178288][  T417] R10: 00007f5508893720 R11: 0000000000000293 R12: 0000555557cb4bb4
[   77.178288][  T417] R13: 0000000000000010 R14: 0000555557cb4bb0 R15: 0000000000000001
[   77.178288][  T417]  </TASK>
[   77.178288][  T417] 
[   77.178288][  T417] Allocated by task 417:
[   77.178288][  T417]  kasan_save_stack+0x24/0x50
[   77.178288][  T417]  kasan_save_track+0x14/0x30
[   77.178288][  T417]  __kasan_kmalloc+0xaa/0xb0
[   77.178288][  T417]  __kmalloc_noprof+0x1ef/0x570
[   77.178288][  T417]  hfsplus_find_init+0x95/0x1f0
[   77.178288][  T417]  hfsplus_readdir+0x222/0xfd0
[   77.178288][  T417]  iterate_dir+0x534/0xb40
[   77.178288][  T417]  __x64_sys_getdents64+0x154/0x2e0
[   77.178288][  T417]  do_syscall_64+0xc3/0x1d0
[   77.178288][  T417]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[   77.178288][  T417] 
[   77.178288][  T417] The buggy address belongs to the object at ff11000009979000
[   77.178288][  T417]  which belongs to the cache kmalloc-2k of size 2048
[   77.178288][  T417] The buggy address is located 0 bytes to the right of
[   77.178288][  T417]  allocated 1036-byte region [ff11000009979000, ff1100000997940c)
[   77.178288][  T417] 
[   77.178288][  T417] The buggy address belongs to the physical page:
[   77.178288][  T417] page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x9978
[   77.178288][  T417] head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0
[   77.178288][  T417] anon flags: 0x100000000000040(head|node=0|zone=1)
[   77.178288][  T417] page_type: f5(slab)
[   77.178288][  T417] raw: 0100000000000040 ff1100000103cf00 0000000000000000 dead000000000001
[   77.178288][  T417] raw: 0000000000000000 0000000000080008 00000001f5000000 0000000000000000
[   77.178288][  T417] head: 0100000000000040 ff1100000103cf00 0000000000000000 dead000000000001
[   77.178288][  T417] head: 0000000000000000 0000000000080008 00000001f5000000 0000000000000000
[   77.178288][  T417] head: 0100000000000003 ffd4000000265e01 ffffffffffffffff 0000000000000000
[   77.178288][  T417] head: 0000000000000008 0000000000000000 00000000ffffffff 0000000000000000
[   77.178288][  T417] page dumped because: kasan: bad access detected
[   77.178288][  T417] 
[   77.178288][  T417] Memory state around the buggy address:
[   77.178288][  T417]  ff11000009979300: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   77.178288][  T417]  ff11000009979380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[   77.178288][  T417] >ff11000009979400: 00 04 fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   77.178288][  T417]                       ^
[   77.178288][  T417]  ff11000009979480: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   77.178288][  T417]  ff11000009979500: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   77.178288][  T417] ==================================================================
[   77.344193][  T417] Disabling lock debugging due to kernel taint

VM DIAGNOSIS:
23:25:08  Registers:
info registers vcpu 0
RAX=0000000000000030 RBX=0000000000000000 RCX=0000000000000000 RDX=00000000000003f8
RSI=ff11000014314680 RDI=ffffffffb0f4c180 RBP=ffffffffb0f4c140 RSP=ffa00000037873b0
R8 =fff3fc00006f0e00 R9 =ffe21c0000e5a047 R10=ffe21c0000e5a046 R11=ff110000072d0237
R12=0000000000000000 R13=0000000000000030 R14=0000000000000000 R15=0000000000000010
RIP=ffffffff9e358a4f RFL=00000002 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000555557cab880 00000000 00000000
GS =0000 ff11000053800000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe6cb50dd000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe6cb50db000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=0000555557cbcbe8 CR3=000000001547e006 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=00000000000000000000ff00000000ff XMM01=25252525252525252525252525252525
XMM02=00000000000000000000000000000000 XMM03=00000000000000000000000000000000
XMM04=00000000000000000000ff00000000ff XMM05=0000ff0000000000ff00000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=00000000000000000000000000000000 XMM09=00000000000000000000000000000000
XMM10=00000000000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
info registers vcpu 1
RAX=0000000080808000 RBX=ffa00000036b7cd0 RCX=ffffffff9b4ec914 RDX=0000000000000000
RSI=ffa00000036b7cd0 RDI=0000000000000002 RBP=ffffffff9b522fe1 RSP=ffa00000036b7a98
R8 =8080808080808000 R9 =ff11000009b8d0b8 R10=fffffbfff4e779c2 R11=ffffffffa73bce17
R12=0000000000000000 R13=ff1100000866dbe8 R14=ff1100000866dbe8 R15=ffa00000036b7cd0
RIP=ffffffff9b09a250 RFL=00000282 [--S----] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f2edb1c78c0 00000000 00000000
GS =0000 ff11000053880000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe0c53c1b000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0c53c19000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=000055e6a43ac000 CR3=0000000008c4a005 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=000000000000000000006c696146002f XMM01=0000000000000000000000000064002f
XMM02=ffffffffffffffffffffffffff0f0e0d XMM03=6572206f742064656c69614600737973
XMM04=00000000000000000000000000000000 XMM05=00000000000000000000000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=20202020000000000000000000000000 XMM09=ffffffff000000000000000000000000
XMM10=20202020000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
info registers vcpu 2
RAX=0000000000000000 RBX=ff110000052f7e00 RCX=ffffffff9d881b55 RDX=0000000000000000
RSI=ff11000006928000 RDI=0000000000000002 RBP=ffffffff9d881b63 RSP=ffa0000003697a68
R8 =0000000000000000 R9 =fffffbfff5a5eadc R10=fffffbfff5a5eadb R11=0000000000000001
R12=ffa0000003697ba8 R13=ff1100000b957b10 R14=0000000000000000 R15=0000000000000000
RIP=ffffffff9b09a250 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f2edb1c78c0 00000000 00000000
GS =0000 ff11000053900000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe508e65e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe508e65c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f2edb758970 CR3=0000000008e8a001 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=0000000000000000002f2e2e2f002e2e XMM01=000000000000000000006c696146002f
XMM02=ffffffffffffffffff0f0e0d0c0b0a09 XMM03=00000000000000410000726500716d2f
XMM04=00007f2edb6a5c01000000725f6d616e XMM05=00000000000000000000000000000000
XMM06=00000000000000000000000000000000 XMM07=00000000000000000000000000000000
XMM08=20202020000000000000000000000000 XMM09=ffffffff000000000000000000000000
XMM10=20202020000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
info registers vcpu 3
RAX=ffffffffa7bc47c7 RBX=1ff4000000003ee4 RCX=ffffffffa7bc47c2 RDX=0000000000000000
RSI=0000000000000000 RDI=ffffffffa7bc47c6 RBP=0000000000000001 RSP=ffa000000001f6e0
R8 =ffffffffa7bc47c6 R9 =ffffffffa7bc47c2 R10=0000000000086001 R11=0000000000025845
R12=ffa000000001fb60 R13=ffa000000001f820 R14=ffa000000001f7d8 R15=ffa000000001fb58
RIP=ffffffff9abf5f25 RFL=00000213 [----A-C] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fa8f6b0b900 00000000 00000000
GS =0000 ff11000053980000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe3a5741a000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe3a57418000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00005615cfdbbf38 CR3=000000000ba72006 CR4=00771ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
XMM00=0000000000000000000046000d0a0920 XMM01=ffffffffffffffffffff0f0e0d0c0b0a
XMM02=ffffffff0f0e0d0c0b0a090807060504 XMM03=00007fa8f758889500006400642e7465
XMM04=40404040404040404040404040404040 XMM05=5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
XMM06=20202020202020202020202020202020 XMM07=ffff00ffffffffffffffffff00ffffff
XMM08=00200000000000000000002000000000 XMM09=00ffffffffffffff00ffff0000ffffff
XMM10=00000000000000000000000000000000 XMM11=00000000000000000000000000000000
XMM12=00000000000000000000000000000000 XMM13=00000000000000000000000000000000
XMM14=00000000000000000000000000000000 XMM15=00000000000000000000000000000000
